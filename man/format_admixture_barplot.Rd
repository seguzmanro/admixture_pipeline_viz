% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{format_admixture_barplot}
\alias{format_admixture_barplot}
\title{Format admixture bar plot}
\usage{
format_admixture_barplot(
  q_matrix,
  popmap,
  k_value,
  sort_populations = TRUE,
  title = NULL
)
}
\arguments{
\item{q_matrix}{Data frame with admixture proportions (numeric matrix).
Rows represent individuals, columns represent genetic clusters.}

\item{popmap}{Population map data frame (data.frame).
Two-column data frame with sample IDs and population assignments.}

\item{k_value}{Current K value (integer).
Number of genetic clusters (columns in q_matrix).}

\item{sort_populations}{Whether to sort by population (logical, default: TRUE).
If TRUE, sorts individuals by population and cluster dominance.}

\item{title}{Custom title for the plot (character, optional).
If NULL, generates automatic title based on K value.}
}
\value{
Formatted ggplot object ready for display or saving.
}
\description{
Creates a publication-ready bar plot showing individual admixture proportions
for each genetic cluster. Individuals are sorted by population and cluster
dominance for better visualization.
}
\details{
The function creates a stacked bar plot where:
\itemize{
  \item{Each bar represents an individual}
  \item{Bar segments show proportion of ancestry from each genetic cluster}
  \item{Individuals are grouped by population (if sort_populations = TRUE)}
  \item{Colors are automatically assigned using the genetic_palette function}
  \item{Plot uses the genomics theme for publication-ready appearance}
}
}
\examples{
\dontrun{
# Create admixture bar plot
q_data <- read_q_file("admixture.3.Q", sample_ids)
popmap <- read.csv("popmap.csv")

bar_plot <- format_admixture_barplot(
  q_matrix = q_data,
  popmap = popmap,
  k_value = 3,
  title = "Population Structure - K = 3"
)

# Save the plot
save_genomics_plot(bar_plot, "admixture_barplot.pdf", width = 10, height = 6)
}
}
