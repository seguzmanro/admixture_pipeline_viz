% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{format_admixture_spatial}
\alias{format_admixture_spatial}
\title{Format spatial admixture map}
\usage{
format_admixture_spatial(
  basemap,
  q_matrix,
  popmap,
  popcoords,
  labels = FALSE,
  title = NULL
)
}
\arguments{
\item{basemap}{Base map tmap object created by create_base_map.
Should include elevation, boundaries, and water features.}

\item{q_matrix}{Data frame with admixture proportions (numeric matrix).
Rows represent individuals, columns represent genetic clusters.}

\item{popmap}{Population map data frame (data.frame).
Two-column data frame with sample IDs and population assignments.}

\item{popcoords}{Population coordinates data frame (data.frame).
Three-column data frame with population names, longitude, and latitude.}

\item{labels}{Add population labels to map (logical, default: FALSE).
If TRUE, adds population names as text labels on the spatial map.}

\item{title}{Custom title for the map (character, optional).
If NULL, generates automatic title based on K value.}

\item{k_value}{Number of genetic clusters (K) (integer, optional).
If NULL, inferred from number of columns in q_matrix.}
}
\value{
tmap object ready for display or saving.
}
\description{
Creates a publication-ready spatial map showing population admixture proportions
as pie charts overlaid on a geographic basemap with elevation, water features,
and administrative boundaries.
}
\details{
The function creates a spatial admixture map where:
\itemize{
  \item{Each pie chart represents a population}
  \item{Pie segments show proportion of ancestry from each genetic cluster}
  \item{Base map includes elevation, water features, and administrative boundaries}
  \item{Population labels can be optionally displayed}
  \item{Colors are automatically assigned using the genetic_palette function}
}
}
\examples{
\dontrun{
# Load required data
basemap <- create_base_map(spatial_data, study_bbox)
q_data <- read_q_file("admixture.3.Q", sample_ids)
popmap <- read.csv("popmap.csv")
coords <- read.csv("coordinates.csv")

# Create spatial admixture map
spatial_map <- format_admixture_spatial(
  basemap = basemap,
  q_matrix = q_data,
  popmap = popmap,
  popcoords = coords,
  labels = TRUE,
  title = "Population Genetic Structure - K = 3"
)

# Save the map
tmap::tmap_save(spatial_map, "admixture_map.png", width = 10, height = 8, dpi = 300)
}
}
